# On récupére les IDs des personnes
personne = {}
file_id = open("id_personne.csv")
for line in file_id:
    a = line.split(";")
    personne[a[0]] = a[1] + a[2]
file_id.close()

# On récupére les IDs des equipes
equipe = {}
file_id = open("id_equipe.csv")
for line in file_id:
    a = line.split(";")
    equipe[a[0]] = a[1]
file_id.close()

# On récupérer les date de début et de fin pour les affectations
finded = []
file = open("date_affectation.csv")
for line in file:
    a = line.split(";")
    for key, value in personne.items():
        if a[0] + a[1] + "\n" == value:
            id_pers = key
    for key, value in equipe.items():
        if a[4] == value:
            id_eq = key
    try:
        if (id_pers, id_eq) in finded:
            pass
        else:
            finded.append((id_pers, id_eq))
            if len(a[3]) > 2:
                print(id_pers, ";", id_eq, ";", a[2], ";", a[3])
            else:
                print(id_pers, ";", id_eq, ";", a[2], ";DEFAULT")
    except:
        pass