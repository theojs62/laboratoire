# On récupére les IDs des personnes
personne = {}
file_id = open("id_personne.csv", "r")
for line in file_id:
    a = line.split(";")
    personne[a[0]] = a[1] + a[2]
file_id.close()

# On récupére les IDs des types de supports
support = {}
file_id = open("id_type_support.csv", "r")
for line in file_id:
    a = line.split(";")
    support[a[0]] = a[1]
file_id.close()

# On récupérer les date de début et de fin pour les supports
finded = []
file = open("date_support.csv", "r")
for line in file:
    a = line.split(";")
    for key, value in personne.items():
        if a[0] + a[1] + "\n" == value:
            id_pers = key
    for key, value in support.items():
        if a[2] == value:
            id_support = key
    try:
        if (id_pers, id_support) in finded:
            pass
        else:
            finded.append((id_pers, id_support))
            if len(a[4]) > 2:
                print(id_pers, ";", id_support, ";", a[3], ";", a[4], ";", a[5])
            else:
                print(id_pers, ";", id_support, ";", a[3], ";DEFAULT;", a[5])
    except:
        pass